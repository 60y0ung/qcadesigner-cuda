\begin{algorithm}[h!tb]
  \dontprintsemicolon
  \SetKwData{NumSamples}{numberOfSamples}\SetKwData{MaxIter}{maxIterations}\SetKwData{NumColors}{numberOfColors}\SetKwData{Stable}{stable}
  \SetKwData{NCellLayers}{nCellLayers}\SetKwData{NCellsPerLayer}{nCellsPerLayer}
  \SetKwFunction{MemcpyToGPU}{MemcpyToGPU}\SetKwFunction{MemcpyToCPU}{MemcpyToCPU}\SetKwFunction{UpdateInputs}{UpdateInputs}
  \SetKwFunction{ComputePol}{ComputePolarization}\SetKwFunction{Randomize}{RandomizeCells}
  \SetKwFunction{GetPolarization}{Polarization}\SetKwFunction{CollectOutputs}{CollectOutputs}
  \SetKwInOut{Input}{input}\SetKwInOut{Output}{output}\SetKw{KwAnd}{and}\SetKw{KwNot}{not} 
  \SetKwFor{While}{while}{do}{endw}
  \KwData{$NewP:$}
  \BlankLine
  \For{$j\leftarrow 0$ \KwTo \NumSamples}
  {
    \UpdateInputs{$Pol$}\;
    \Randomize{$Pol$}\;\label{alg:rand}
    $i \leftarrow 0$\;
    $stable \leftarrow false$\;
    \While{$i<$\MaxIter  \KwAnd \KwNot $stable$}
    {
     \For{$k \leftarrow 0$ \KwTo \NCellLayers}
      {
	\For{$l \leftarrow 0$ \KwTo \NCellsPerLayer}
	{
	  $OldP \leftarrow$ $Pol_{k,l}$\;
	  $NewP \leftarrow$ \ComputePol{$Pol_{k,l}$}\;
	  $stable \leftarrow$ (($|NewP - OldP| < tolerance$) \KwAnd $stable$)\;\label{alg:tolerance}
	  $Pol_{k,l} \leftarrow NewP$\;
	}
      }
     }
   \CollectOutputs{$Pol$}\;
  }
  \caption{Original Bistable Engine Pseudocode}\label{algo_bist_serial}
\end{algorithm}
