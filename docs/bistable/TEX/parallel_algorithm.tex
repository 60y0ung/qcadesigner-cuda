\begin{algorithm}\label{alg:DUenc}
  \SetKwFunction{UpdateInputsKernel}{update_inputs_kernel}\SetKwFunction{BistableKernel}{bistable_kernel}
  \SetKwFunction{memCopyToGPU}{memcpy-to-gpu}\SetKwFunction{memCopyToCPU}{memcpy-to-cpu}\SetKwFunction{StabilityChecking}{stability-checking}
  \SetKwFunction{NumSamples}{number-of-samples}\SetKwFunction{MaxIter}{max-iterations}\SetKwFunction{NumColors}{number-of-colors}
  \SetKwFor{For}{for}{do}{od}\SetKwIF{If}{ElseIf}{Else}{if}{then}{else if}{else}{endif} \SetKwFor{While}{while}{do}{od}
  \SetKwBlock{Begin}{begin}{end}
\BlankLine  
  \memCopyToGPU()\;
  \For{$j\leftarrow 0$ \KwTo \NumSamples}{
      \UpdateInputsKernel()\;
      $i \leftarrow 0$\;
      \While{$i <$ \MaxIter \wedge $\neg stable$ }{
	\For{$k\leftarrow 0$ \KwTo \NumColors}{
	    \BistableKernel()\;
	}
      \memCopyToCPU($dS$)\;
      $g \leftarrow$\StabilityChecking($S$)\;}
  \memCopyToCPU($dOut$)\;
  }

\caption{Parallel Bistable Simulation Engine}
\end{algorithm}
