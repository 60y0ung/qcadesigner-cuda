\begin{algorithm}[h!tb]
  \SetKwData{NumSamples}{numberOfSamples}\SetKwData{MaxIter}{maxIterations}\SetKwData{NumColors}{numberOfColors}\SetKwData{Stable}{stable}
  \SetKwFunction{MemcpyToDevice}{MemcpyToDevice}\SetKwFunction{MemcpyToHost}{MemcpyToHost}\SetKwFunction{UpdateInputs}{UpdateInputsKernel}
  \SetKwFunction{BistableKernel}{BistableKernel}\SetKwFunction{StabCheck}{StabilityChecking}
  \SetKwInOut{Input}{input}\SetKwInOut{Output}{output}\SetKw{KwAnd}{and not}
  \SetKwFor{While}{while}{do}{endw}
  \BlankLine
  \MemcpyToDevice{}\;
  \For{$j\leftarrow$ \KwTo \NumSamples}
  {
    \UpdateInputs{$polarizations, inputIdxs, j$}\;
    $i \leftarrow 0$\;
    \While{$i<$\MaxIter  \KwAnd $stable$}
    {
    \BistableKernel{$pol,clK,eK,nbIdxs,stabArray,colors,k$}\;\label{alg:bistkernel}
    \MemcpyToHost{$stabArray$}\;
    $stable$ $\leftarrow$ \StabCheck{$stabArray$}\;
    }
    \MemcpyToHost($outputs$)\;
  }
  
  \caption{Parallel Bistable Engine Pseudocode}\label{algo_bist_parallel_failure}
\end{algorithm}
